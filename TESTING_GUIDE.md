# æµ‹è¯•æŒ‡å—å®Œæ•´æ–‡æ¡£

## ğŸ“‹ ç›®å½•

- [å½“å‰æµ‹è¯•æ–‡ä»¶æ¸…å•](#å½“å‰æµ‹è¯•æ–‡ä»¶æ¸…å•)
- [å»ºè®®çš„ç®¡ç†æ–¹æ¡ˆ](#å»ºè®®çš„ç®¡ç†æ–¹æ¡ˆ)
- [æ¨èæ‰§è¡Œæ–¹æ¡ˆ](#æ¨èæ‰§è¡Œæ–¹æ¡ˆ)
- [æ‰§è¡Œå‘½ä»¤](#æ‰§è¡Œå‘½ä»¤)
- [æµ‹è¯•æ–‡ä»¶è¯´æ˜](#æµ‹è¯•æ–‡ä»¶è¯´æ˜)
- [è¿è¡Œæµ‹è¯•çš„æœ€ä½³å®è·µ](#è¿è¡Œæµ‹è¯•çš„æœ€ä½³å®è·µ)
- [ç»´æŠ¤å»ºè®®](#ç»´æŠ¤å»ºè®®)
- [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„)
- [å½“å‰ä¿ç•™çš„æµ‹è¯•æ–‡ä»¶](#å½“å‰ä¿ç•™çš„æµ‹è¯•æ–‡ä»¶)
- [æµ‹è¯•æ–‡ä»¶ç®¡ç†](#æµ‹è¯•æ–‡ä»¶ç®¡ç†)
- [è¿è¡Œæµ‹è¯•çš„æœ€ä½³å®è·µ](#è¿è¡Œæµ‹è¯•çš„æœ€ä½³å®è·µ)
- [ç»´æŠ¤å»ºè®®](#ç»´æŠ¤å»ºè®®)
- [æ–‡ä»¶ç»“æ„](#æ–‡ä»¶ç»“æ„)

---

## å½“å‰æµ‹è¯•æ–‡ä»¶æ¸…å•

### å‚è€ƒéŸ³é¢‘åŠŸèƒ½æµ‹è¯•æ–‡ä»¶
1. `test_ref_audio.py` - åŸºç¡€å‚è€ƒéŸ³é¢‘ä¸Šä¼ æµ‹è¯•
2. `test_ref_audio_complete.py` - å®Œæ•´çš„å‚è€ƒéŸ³é¢‘åŠŸèƒ½æµ‹è¯•ï¼ˆåŒ…å«ç™»å½•ã€æ­Œè¯ç”Ÿæˆã€ä¿å­˜ï¼‰
3. `test_ref_audio_fix.py` - ä¿®å¤åçš„å‚è€ƒéŸ³é¢‘åŠŸèƒ½æµ‹è¯•
4. `test_final_ref_audio.py` - æœ€ç»ˆéªŒè¯æµ‹è¯•
5. `test_simple_upload.py` - ç®€å•æ–‡ä»¶ä¸Šä¼ æµ‹è¯•

### è·¯ç”±å’ŒåŠŸèƒ½æµ‹è¯•æ–‡ä»¶
6. `test_routes_direct.py` - ç›´æ¥è·¯ç”±æµ‹è¯•
7. `test_route.py` - è·¯ç”±çŠ¶æ€æ£€æŸ¥
8. `test_version.py` - ç‰ˆæœ¬æ£€æŸ¥æµ‹è¯•

### æ•°æ®åˆ›å»ºå’Œç¦»çº¿æµ‹è¯•æ–‡ä»¶
9. `create_test_data.py` - åˆ›å»ºæµ‹è¯•æ•°æ®
10. `test_offline.py` - ç¦»çº¿åŠŸèƒ½æµ‹è¯•

## å»ºè®®çš„ç®¡ç†æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€ï¼šåˆ›å»ºæµ‹è¯•ç›®å½•ï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºæµ‹è¯•ç›®å½•
mkdir tests
mkdir tests/ref_audio
mkdir tests/routes
mkdir tests/data

# ç§»åŠ¨æµ‹è¯•æ–‡ä»¶
mv test_ref_audio*.py tests/ref_audio/
mv test_final_ref_audio.py tests/ref_audio/
mv test_simple_upload.py tests/ref_audio/
mv test_routes_direct.py tests/routes/
mv test_route.py tests/routes/
mv test_version.py tests/routes/
mv create_test_data.py tests/data/
mv test_offline.py tests/data/
```

### æ–¹æ¡ˆäºŒï¼šæ¸…ç†å’Œä¿ç•™

ä¿ç•™æœ€é‡è¦çš„æµ‹è¯•æ–‡ä»¶ï¼Œåˆ é™¤è¿‡æ—¶çš„ï¼š

**ä¿ç•™æ–‡ä»¶ï¼š**
- `test_ref_audio_fix.py` - æœ€æ–°çš„ä¿®å¤éªŒè¯æµ‹è¯•
- `create_test_data.py` - æ•°æ®åˆ›å»ºå·¥å…·
- `test_offline.py` - ç¦»çº¿åŠŸèƒ½æµ‹è¯•

**åˆ é™¤æ–‡ä»¶ï¼š**
- `test_ref_audio.py` - å·²è¢«æ›´å®Œæ•´çš„æµ‹è¯•æ›¿ä»£
- `test_ref_audio_complete.py` - å·²è¢«ä¿®å¤ç‰ˆæœ¬æ›¿ä»£
- `test_final_ref_audio.py` - å·²è¢«ä¿®å¤ç‰ˆæœ¬æ›¿ä»£
- `test_simple_upload.py` - ç®€å•ç‰ˆæœ¬ï¼ŒåŠŸèƒ½å·²åˆå¹¶
- `test_routes_direct.py` - ä¸´æ—¶æµ‹è¯•æ–‡ä»¶
- `test_route.py` - ä¸´æ—¶æµ‹è¯•æ–‡ä»¶
- `test_version.py` - ä¸´æ—¶æµ‹è¯•æ–‡ä»¶

### æ–¹æ¡ˆä¸‰ï¼šå½’æ¡£ç®¡ç†

```bash
# åˆ›å»ºå½’æ¡£ç›®å½•
mkdir test_archive
mkdir test_archive/ref_audio_development
mkdir test_archive/route_testing
mkdir test_archive/working_tests

# ç§»åŠ¨æ–‡ä»¶åˆ°å½’æ¡£
mv test_ref_audio.py test_archive/ref_audio_development/
mv test_ref_audio_complete.py test_archive/ref_audio_development/
mv test_final_ref_audio.py test_archive/ref_audio_development/
mv test_simple_upload.py test_archive/ref_audio_development/
mv test_routes_direct.py test_archive/route_testing/
mv test_route.py test_archive/route_testing/
mv test_version.py test_archive/route_testing/

# ä¿ç•™å·¥ä½œæµ‹è¯•
# test_ref_audio_fix.py ä¿ç•™åœ¨æ ¹ç›®å½•
# create_test_data.py ä¿ç•™åœ¨æ ¹ç›®å½•
# test_offline.py ä¿ç•™åœ¨æ ¹ç›®å½•
```

## æ¨èæ‰§è¡Œæ–¹æ¡ˆ

æˆ‘å»ºè®®é‡‡ç”¨**æ–¹æ¡ˆäºŒï¼šæ¸…ç†å’Œä¿ç•™**ï¼Œå› ä¸ºï¼š

1. **ç®€æ´æ€§**ï¼šåªä¿ç•™å¿…è¦çš„æµ‹è¯•æ–‡ä»¶
2. **åŠŸèƒ½æ€§**ï¼šä¿ç•™çš„æµ‹è¯•è¦†ç›–äº†æ‰€æœ‰é‡è¦åŠŸèƒ½
3. **ç»´æŠ¤æ€§**ï¼šå‡å°‘æ–‡ä»¶æ•°é‡ï¼Œä¾¿äºç®¡ç†

## æ‰§è¡Œå‘½ä»¤

```bash
# åˆ é™¤è¿‡æ—¶çš„æµ‹è¯•æ–‡ä»¶
rm test_ref_audio.py
rm test_ref_audio_complete.py
rm test_final_ref_audio.py
rm test_simple_upload.py
rm test_routes_direct.py
rm test_route.py
rm test_version.py

# ä¿ç•™çš„æ–‡ä»¶ï¼š
# - test_ref_audio_fix.py (å‚è€ƒéŸ³é¢‘åŠŸèƒ½éªŒè¯)
# - create_test_data.py (æ•°æ®åˆ›å»ºå·¥å…·)
# - test_offline.py (ç¦»çº¿åŠŸèƒ½æµ‹è¯•)
```

## æµ‹è¯•æ–‡ä»¶è¯´æ˜

### ä¿ç•™çš„æµ‹è¯•æ–‡ä»¶

1. **test_ref_audio_fix.py**
   - ç”¨é€”ï¼šéªŒè¯å‚è€ƒéŸ³é¢‘åŠŸèƒ½çš„å®Œæ•´æµç¨‹
   - åŠŸèƒ½ï¼šç™»å½•ã€ä¸Šä¼ æ–‡ä»¶ã€ç”Ÿæˆæ­Œæ›²ã€éªŒè¯ç»“æœ
   - çŠ¶æ€ï¼šâœ… å·¥ä½œæ­£å¸¸

2. **create_test_data.py**
   - ç”¨é€”ï¼šåˆ›å»ºæµ‹è¯•ç”¨æˆ·å’Œæ­Œè¯æ•°æ®
   - åŠŸèƒ½ï¼šæ‰¹é‡åˆ›å»ºæµ‹è¯•æ•°æ®
   - çŠ¶æ€ï¼šâœ… å·¥ä½œæ­£å¸¸

3. **test_offline.py**
   - ç”¨é€”ï¼šæµ‹è¯•ç¦»çº¿åŠŸèƒ½
   - åŠŸèƒ½ï¼šéªŒè¯ç½‘ç»œçŠ¶æ€å’Œç¦»çº¿æ¨¡å¼
   - çŠ¶æ€ï¼šâœ… å·¥ä½œæ­£å¸¸

### åˆ é™¤çš„æµ‹è¯•æ–‡ä»¶

è¿™äº›æ–‡ä»¶éƒ½æ˜¯å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸´æ—¶æµ‹è¯•æ–‡ä»¶ï¼ŒåŠŸèƒ½å·²è¢«æ›´å®Œå–„çš„æµ‹è¯•æ›¿ä»£æˆ–ä¸å†éœ€è¦ã€‚

---

## å½“å‰ä¿ç•™çš„æµ‹è¯•æ–‡ä»¶

### 1. test_ref_audio_fix.py - å‚è€ƒéŸ³é¢‘åŠŸèƒ½æµ‹è¯•

**ç”¨é€”**ï¼šéªŒè¯å‚è€ƒéŸ³é¢‘ä¸Šä¼ åŠŸèƒ½çš„å®Œæ•´æµç¨‹

**åŠŸèƒ½**ï¼š
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- ä¸Šä¼ å‚è€ƒéŸ³é¢‘æ–‡ä»¶
- ç”Ÿæˆæ­Œæ›²
- éªŒè¯ç»“æœå’Œæ–‡ä»¶ä¿å­˜

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
# ç¡®ä¿åº”ç”¨æ­£åœ¨è¿è¡Œ
conda activate writesong
python app.py --port 8527

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œæµ‹è¯•
python test_ref_audio_fix.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
å¼€å§‹æµ‹è¯•ä¿®å¤åçš„å‚è€ƒéŸ³é¢‘åŠŸèƒ½...
1. æ³¨å†Œå¹¶ç™»å½•...
2. æµ‹è¯•å‚è€ƒéŸ³é¢‘ä¸Šä¼ ...
å‘é€å‚è€ƒéŸ³é¢‘ä¸Šä¼ è¯·æ±‚...
å“åº”çŠ¶æ€ç : 200
âœ… å‚è€ƒéŸ³é¢‘åŠŸèƒ½ä¿®å¤æˆåŠŸï¼
ç”Ÿæˆçš„æ­Œæ›²URL: /song/song_12_20250730_120451.mp3
âœ… uploadsç›®å½•å·²åˆ›å»ºï¼ŒåŒ…å« X ä¸ªå‚è€ƒéŸ³é¢‘æ–‡ä»¶
æµ‹è¯•å®Œæˆ
```

### 2. test_offline.py - ç¦»çº¿åŠŸèƒ½æµ‹è¯•

**ç”¨é€”**ï¼šæµ‹è¯•åº”ç”¨çš„ç¦»çº¿åŠŸèƒ½å’Œç½‘ç»œçŠ¶æ€ç›‘æ§

**åŠŸèƒ½**ï¼š
- æµ‹è¯•æœåŠ¡å™¨è¿æ¥æ€§
- éªŒè¯é™æ€æ–‡ä»¶è®¿é—®
- æ£€æŸ¥ç½‘ç»œçŠ¶æ€é¡µé¢
- æµ‹è¯•ç¦»çº¿æ¨¡å¼

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
python test_offline.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
æµ‹è¯•æœåŠ¡å™¨è¿æ¥æ€§...
âœ… æœåŠ¡å™¨è¿æ¥æ­£å¸¸
æµ‹è¯•é™æ€æ–‡ä»¶è®¿é—®...
âœ… é™æ€æ–‡ä»¶è®¿é—®æ­£å¸¸
æµ‹è¯•ç½‘ç»œçŠ¶æ€é¡µé¢...
âœ… ç½‘ç»œçŠ¶æ€é¡µé¢æ­£å¸¸
```

### 3. create_test_data.py - æµ‹è¯•æ•°æ®åˆ›å»ºå·¥å…·

**ç”¨é€”**ï¼šæ‰¹é‡åˆ›å»ºæµ‹è¯•ç”¨æˆ·å’Œæ­Œè¯æ•°æ®

**åŠŸèƒ½**ï¼š
- åˆ›å»ºæµ‹è¯•ç”¨æˆ·
- ç”Ÿæˆæµ‹è¯•æ­Œè¯
- ä¿å­˜æ­Œè¯åˆ°æ•°æ®åº“
- ä¸ºæµ‹è¯•å‡†å¤‡æ•°æ®

**ä½¿ç”¨æ–¹æ³•**ï¼š
```bash
python create_test_data.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
åˆ›å»ºæµ‹è¯•ç”¨æˆ·...
âœ… ç”¨æˆ·åˆ›å»ºæˆåŠŸ: testuser_data
ç”Ÿæˆæµ‹è¯•æ­Œè¯...
âœ… æ­Œè¯ç”ŸæˆæˆåŠŸ
ä¿å­˜æ­Œè¯...
âœ… æ­Œè¯ä¿å­˜æˆåŠŸ
```

## æµ‹è¯•æ–‡ä»¶ç®¡ç†

### æ–‡ä»¶æ¸…ç†å·²å®Œæˆ

å·²åˆ é™¤çš„è¿‡æ—¶æµ‹è¯•æ–‡ä»¶ï¼š
- `test_ref_audio.py` - åŸºç¡€ç‰ˆæœ¬ï¼Œå·²è¢«æ›´å®Œæ•´ç‰ˆæœ¬æ›¿ä»£
- `test_ref_audio_complete.py` - å¼€å‘ç‰ˆæœ¬ï¼Œå·²è¢«ä¿®å¤ç‰ˆæœ¬æ›¿ä»£
- `test_final_ref_audio.py` - éªŒè¯ç‰ˆæœ¬ï¼Œå·²è¢«ä¿®å¤ç‰ˆæœ¬æ›¿ä»£
- `test_simple_upload.py` - ç®€å•ç‰ˆæœ¬ï¼ŒåŠŸèƒ½å·²åˆå¹¶
- `test_routes_direct.py` - ä¸´æ—¶è·¯ç”±æµ‹è¯•
- `test_route.py` - ä¸´æ—¶è·¯ç”±æµ‹è¯•
- `test_version.py` - ä¸´æ—¶ç‰ˆæœ¬æµ‹è¯•

### ä¿ç•™çš„æ–‡ä»¶è¯´æ˜

1. **test_ref_audio_fix.py** - æœ€æ–°çš„å‚è€ƒéŸ³é¢‘åŠŸèƒ½éªŒè¯æµ‹è¯•
   - åŒ…å«å®Œæ•´çš„ç«¯åˆ°ç«¯æµ‹è¯•æµç¨‹
   - éªŒè¯æ–‡ä»¶ä¸Šä¼ ã€ä¿å­˜ã€APIè°ƒç”¨ç­‰æ‰€æœ‰åŠŸèƒ½
   - æ˜¯æœ€é‡è¦çš„åŠŸèƒ½æµ‹è¯•æ–‡ä»¶

2. **test_offline.py** - ç¦»çº¿åŠŸèƒ½æµ‹è¯•
   - éªŒè¯åº”ç”¨çš„ç¦»çº¿æ¨¡å¼
   - æµ‹è¯•ç½‘ç»œçŠ¶æ€ç›‘æ§
   - ç¡®ä¿åº”ç”¨åœ¨ç½‘ç»œä¸ç¨³å®šæ—¶çš„å¯ç”¨æ€§

3. **create_test_data.py** - æ•°æ®åˆ›å»ºå·¥å…·
   - ç”¨äºå¿«é€Ÿåˆ›å»ºæµ‹è¯•æ•°æ®
   - æ”¯æŒå¼€å‘å’Œè°ƒè¯•
   - å¯ä»¥é‡å¤ä½¿ç”¨

## è¿è¡Œæµ‹è¯•çš„æœ€ä½³å®è·µ

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# æ¿€æ´»æ­£ç¡®çš„ç¯å¢ƒ
conda activate writesong

# ç¡®ä¿åº”ç”¨æ­£åœ¨è¿è¡Œ
python app.py --port 8527
```

### 2. æµ‹è¯•é¡ºåº
```bash
# 1. é¦–å…ˆåˆ›å»ºæµ‹è¯•æ•°æ®
python create_test_data.py

# 2. æµ‹è¯•å‚è€ƒéŸ³é¢‘åŠŸèƒ½
python test_ref_audio_fix.py

# 3. æµ‹è¯•ç¦»çº¿åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰
python test_offline.py
```

### 3. æ•…éšœæ’é™¤

å¦‚æœæµ‹è¯•å¤±è´¥ï¼š

1. **æ£€æŸ¥åº”ç”¨çŠ¶æ€**ï¼š
   ```bash
   ps aux | grep "python app.py"
   ```

2. **æ£€æŸ¥ç«¯å£å ç”¨**ï¼š
   ```bash
   netstat -tlnp | grep 8527
   ```

3. **é‡å¯åº”ç”¨**ï¼š
   ```bash
   pkill -f "python app.py"
   conda activate writesong
   python app.py --port 8527
   ```

4. **æ£€æŸ¥æ•°æ®åº“**ï¼š
   ```bash
   sqlite3 instance/db.sqlite3 "SELECT * FROM user LIMIT 5;"
   ```

## ç»´æŠ¤å»ºè®®

1. **å®šæœŸè¿è¡Œæµ‹è¯•**ï¼šç¡®ä¿åŠŸèƒ½æ­£å¸¸å·¥ä½œ
2. **æ›´æ–°æµ‹è¯•æ•°æ®**ï¼šæ ¹æ®éœ€è¦ä¿®æ”¹æµ‹è¯•å‚æ•°
3. **å¤‡ä»½é‡è¦æµ‹è¯•**ï¼šåœ¨é‡å¤§æ›´æ”¹å‰å¤‡ä»½æµ‹è¯•æ–‡ä»¶
4. **æ–‡æ¡£æ›´æ–°**ï¼šå½“åŠŸèƒ½å˜åŒ–æ—¶æ›´æ–°æµ‹è¯•è¯´æ˜

## æ–‡ä»¶ç»“æ„

æ¸…ç†åçš„é¡¹ç›®ç»“æ„ï¼š
```
writesong/
â”œâ”€â”€ app.py                    # ä¸»åº”ç”¨
â”œâ”€â”€ test_ref_audio_fix.py    # å‚è€ƒéŸ³é¢‘åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ test_offline.py          # ç¦»çº¿åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ create_test_data.py      # æµ‹è¯•æ•°æ®åˆ›å»ºå·¥å…·
â”œâ”€â”€ TESTING_GUIDE.md        # æµ‹è¯•æŒ‡å—
â””â”€â”€ REF_AUDIO_COMPLETE.md   # å‚è€ƒéŸ³é¢‘åŠŸèƒ½æ–‡æ¡£
``` 